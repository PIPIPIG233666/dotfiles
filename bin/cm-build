#!/bin/bash

if [ -z "$1" ];
then
echo "Usage: build-cm <device> <sync,dirty,clean,bootimage,upload>"
else
cd /home/parth/cm
export KBUILD_BUILD_USER=ParthB
export KBUILD_BUILD_HOST=Triton
if [[ "$2" =~ "sync" ]];
then
syncc;
fi
source build/envsetup.sh
breakfast $1
if [[ "$2" =~ "dirty" ]];
then
make installclean
fi
if [[ "$2" =~ "clean" ]];
then
make clobber
fi
if [ -f "${OUT}/system/build.prop" ]; then
rm -vf "${OUT}/system/build.prop"
fi
if [ -f "${OUT}/obj/ETC/system_build_prop_intermediates/build.prop" ]; then
rm -vf "${OUT}/obj/ETC/system_build_prop_intermediates/build.prop"
fi
if [[ "$2" =~ "bootimage" ]];
then
make -j32 bootimage
else
time make -j32 bacon
fi
if [[ "$2" =~ "upload" ]];
then
if [[ "$1" =~ "kenzo" || "$1" =~ "cm_kenzo-eng" ]];
then
gdrive upload --parent 0B9JxQ_RHblHkQXBlM1BEcHNjOUU ~/cm/out/target/product/kenzo/cm-*.zip
fi
if [[ "$1" =~ "hydrogen" || "$1" =~ "cm_hydrogen-eng" ]];
then
gdrive upload --parent 0B9JxQ_RHblHkU1IxaW1mTEVfMEE ~/cm/out/target/product/hydrogen/cm-*.zip
fi
fi
jack-kill
fi
